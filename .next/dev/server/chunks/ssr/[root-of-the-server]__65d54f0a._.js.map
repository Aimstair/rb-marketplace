{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///E:/Files/Documents/Projects/Marketplace/github/rb-marketplace/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\"\r\n\r\nconst globalForPrisma = global as unknown as { prisma: PrismaClient }\r\n\r\nexport const prisma =\r\n  globalForPrisma.prisma ||\r\n  new PrismaClient({\r\n    log: [\"query\"],\r\n  })\r\n\r\nif (process.env.NODE_ENV !== \"production\") globalForPrisma.prisma = prisma\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM;AAEC,MAAM,SACX,gBAAgB,MAAM,IACtB,IAAI,6IAAY,CAAC;IACf,KAAK;QAAC;KAAQ;AAChB;AAEF,wCAA2C,gBAAgB,MAAM,GAAG"}},
    {"offset": {"line": 27, "column": 0}, "map": {"version":3,"sources":["file:///E:/Files/Documents/Projects/Marketplace/github/rb-marketplace/app/actions/listings.ts"],"sourcesContent":["\"use server\"\r\n\r\nimport { prisma } from \"@/lib/prisma\"\r\n\r\nexport interface ListingFilters {\r\n  search?: string\r\n  mainCategory?: string\r\n  selectedGame?: string\r\n  selectedItemType?: string\r\n  sortBy?: string\r\n  priceRange?: {\r\n    min: number\r\n    max: number\r\n  }\r\n  page?: number\r\n  itemsPerPage?: number\r\n}\r\n\r\nexport interface ListingResponse {\r\n  id: string\r\n  title: string\r\n  game: string\r\n  price: number\r\n  image: string\r\n  seller: {\r\n    id: string\r\n    username: string\r\n  }\r\n  vouch: number\r\n  status: string\r\n  category: string\r\n  itemType: string\r\n  condition: string\r\n  upvotes: number\r\n  downvotes: number\r\n  featured: boolean\r\n}\r\n\r\nexport interface GetListingsResult {\r\n  listings: ListingResponse[]\r\n  total: number\r\n  totalPages: number\r\n  currentPage: number\r\n}\r\n\r\nexport async function getListings(\r\n  filters: ListingFilters = {}\r\n): Promise<GetListingsResult> {\r\n  const {\r\n    search = \"\",\r\n    mainCategory = \"All\",\r\n    selectedGame = \"All Games\",\r\n    selectedItemType = \"All\",\r\n    sortBy = \"newest\",\r\n    priceRange = { min: 0, max: 1000000 },\r\n    page = 1,\r\n    itemsPerPage = 9,\r\n  } = filters\r\n\r\n  try {\r\n    // Build where clause\r\n    const where: any = {\r\n      status: \"available\",\r\n    }\r\n\r\n    // Search filter\r\n    if (search) {\r\n      where.OR = [\r\n        {\r\n          title: {\r\n            contains: search,\r\n            mode: \"insensitive\",\r\n          },\r\n        },\r\n        {\r\n          seller: {\r\n            username: {\r\n              contains: search,\r\n              mode: \"insensitive\",\r\n            },\r\n          },\r\n        },\r\n      ]\r\n    }\r\n\r\n    // Category filter\r\n    if (mainCategory === \"Featured\") {\r\n      where.featured = true\r\n    } else if (mainCategory !== \"All\" && mainCategory !== \"Accessories\") {\r\n      where.category = mainCategory\r\n    } else if (mainCategory === \"Accessories\") {\r\n      where.category = \"Accessories\"\r\n    }\r\n\r\n    // Game filter\r\n    if (selectedGame !== \"All Games\") {\r\n      where.game = selectedGame\r\n    }\r\n\r\n    // Item type filter (only for Games category)\r\n    if (mainCategory === \"Games\" && selectedItemType !== \"All\") {\r\n      where.itemType = selectedItemType\r\n    }\r\n\r\n    // Price range filter\r\n    where.price = {\r\n      gte: priceRange.min,\r\n      lte: priceRange.max,\r\n    }\r\n\r\n    // Build order by\r\n    let orderBy: any = { createdAt: \"desc\" }\r\n\r\n    switch (sortBy) {\r\n      case \"price-asc\":\r\n        orderBy = { price: \"asc\" }\r\n        break\r\n      case \"price-desc\":\r\n        orderBy = { price: \"desc\" }\r\n        break\r\n      case \"vouch\":\r\n        orderBy = { vouchCount: \"desc\" }\r\n        break\r\n      case \"upvotes\":\r\n        orderBy = { upvotes: \"desc\" }\r\n        break\r\n      case \"trending\":\r\n        // For trending, we'll use a combination of upvotes and recent creation\r\n        orderBy = [{ upvotes: \"desc\" }, { createdAt: \"desc\" }]\r\n        break\r\n      default:\r\n        orderBy = { createdAt: \"desc\" }\r\n    }\r\n\r\n    // Get total count\r\n    const total = await prisma.listing.count({ where })\r\n\r\n    // Get paginated listings\r\n    const listings = await prisma.listing.findMany({\r\n      where,\r\n      include: {\r\n        seller: {\r\n          select: {\r\n            id: true,\r\n            username: true,\r\n          },\r\n        },\r\n      },\r\n      orderBy,\r\n      skip: (page - 1) * itemsPerPage,\r\n      take: itemsPerPage,\r\n    })\r\n\r\n    // Transform to response format\r\n    const transformedListings: ListingResponse[] = listings.map((listing: any) => ({\r\n      id: listing.id,\r\n      title: listing.title,\r\n      game: listing.game,\r\n      price: listing.price,\r\n      image: listing.image,\r\n      seller: {\r\n        id: listing.seller.id,\r\n        username: listing.seller.username,\r\n      },\r\n      vouch: listing.vouchCount,\r\n      status: listing.status,\r\n      category: listing.category,\r\n      itemType: listing.itemType,\r\n      condition: listing.condition,\r\n      upvotes: listing.upvotes,\r\n      downvotes: listing.downvotes,\r\n      featured: listing.featured,\r\n    }))\r\n\r\n    const totalPages = Math.ceil(total / itemsPerPage)\r\n\r\n    return {\r\n      listings: transformedListings,\r\n      total,\r\n      totalPages,\r\n      currentPage: page,\r\n    }\r\n  } catch (error) {\r\n    console.error(\"Error fetching listings:\", error)\r\n    throw new Error(\"Failed to fetch listings\")\r\n  }\r\n}\r\n\r\nexport async function getAvailableGames(mainCategory: string = \"All\"): Promise<string[]> {\r\n  try {\r\n    if (mainCategory === \"Accessories\" || mainCategory === \"Featured\") {\r\n      return []\r\n    }\r\n\r\n    const games = await prisma.listing.findMany({\r\n      where: {\r\n        status: \"available\",\r\n        ...(mainCategory !== \"All\" && { category: mainCategory }),\r\n      },\r\n      select: {\r\n        game: true,\r\n      },\r\n      distinct: [\"game\"],\r\n    })\r\n\r\n    const gameList = games\r\n      .map((g: any) => g.game)\r\n      .filter((game: string) => game !== \"Roblox Catalog\")\r\n      .sort()\r\n\r\n    return [\"All Games\", ...gameList]\r\n  } catch (error) {\r\n    console.error(\"Error fetching available games:\", error)\r\n    return [\"All Games\"]\r\n  }\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 222, "column": 0}, "map": {"version":3,"sources":["file:///E:/Files/Documents/Projects/Marketplace/github/rb-marketplace/.next-internal/server/app/marketplace/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {getListings as '40fc12b29cad7f3b83501f2698d876b613877bb426'} from 'ACTIONS_MODULE0'\nexport {getAvailableGames as '40105282f300ef5022879b2c5d5a4bb918dc10c113'} from 'ACTIONS_MODULE0'\n"],"names":[],"mappings":";AAAA"}},
    {"offset": {"line": 242, "column": 0}, "map": {"version":3,"sources":["file:///E:/Files/Documents/Projects/Marketplace/github/rb-marketplace/node_modules/next/src/build/webpack/loaders/next-flight-loader/server-reference.ts"],"sourcesContent":["/* eslint-disable import/no-extraneous-dependencies */\nexport { registerServerReference } from 'react-server-dom-webpack/server'\n"],"names":["registerServerReference"],"mappings":"AAAA,oDAAoD;;;+BAC3CA,2BAAAA;;;eAAAA,QAAAA,uBAAuB;;;wBAAQ","ignoreList":[0]}},
    {"offset": {"line": 256, "column": 0}, "map": {"version":3,"sources":["file:///E:/Files/Documents/Projects/Marketplace/github/rb-marketplace/node_modules/next/src/build/webpack/loaders/next-flight-loader/action-validate.ts"],"sourcesContent":["// This function ensures that all the exported values are valid server actions,\n// during the runtime. By definition all actions are required to be async\n// functions, but here we can only check that they are functions.\nexport function ensureServerEntryExports(actions: any[]) {\n  for (let i = 0; i < actions.length; i++) {\n    const action = actions[i]\n    if (typeof action !== 'function') {\n      throw new Error(\n        `A \"use server\" file can only export async functions, found ${typeof action}.\\nRead more: https://nextjs.org/docs/messages/invalid-use-server-value`\n      )\n    }\n  }\n}\n"],"names":["ensureServerEntryExports","actions","i","length","action","Error"],"mappings":"AAAA,+EAA+E;AAC/E,yEAAyE;AACzE,iEAAiE;;;;+BACjDA,4BAAAA;;;eAAAA;;;AAAT,SAASA,yBAAyBC,OAAc;IACrD,IAAK,IAAIC,IAAI,GAAGA,IAAID,QAAQE,MAAM,EAAED,IAAK;QACvC,MAAME,SAASH,OAAO,CAACC,EAAE;QACzB,IAAI,OAAOE,WAAW,YAAY;YAChC,MAAM,OAAA,cAEL,CAFK,IAAIC,MACR,CAAC,2DAA2D,EAAE,OAAOD,OAAO,uEAAuE,CAAC,GADhJ,qBAAA;uBAAA;4BAAA;8BAAA;YAEN;QACF;IACF;AACF","ignoreList":[0]}}]
}